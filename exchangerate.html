<!DOCTYPE html>
<html>
<head>
    <title>汇率工具</title>
    <style>
        /* Notion风格样式系统 */
        :root {
            --bg-color: #ffffff;
            --surface-color: #f5f5f5;
            --text-primary: #37352f;
            --text-secondary: #787774;
            --accent-color: #2eaadc;
            --border-color: #e0e0e0;
            --border-radius: 6px;
            --font-stack: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, 'Apple Color Emoji', Arial, sans-serif, 'Segoe UI Emoji', 'Segoe UI Symbol';
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg-color: #2f3437;
                --surface-color: #373737;
                --text-primary: #ffffff;
                --text-secondary: #b3b3b3;
                --border-color: #4d4d4d;
            }
        }

        body {
            font-family: var(--font-stack);
            background: transparent !important;
            margin: 0;
            padding: 12px;
            color: var(--text-primary);
        }

        .notion-container {
            background: var(--surface-color);
            border-radius: var(--border-radius);
            border: 1px solid var(--border-color);
            padding: 18px;
            margin-bottom: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.04);
        }

        .notion-title {
            font-size: 16px;
            font-weight: 600;
            margin: 0 0 16px 0;
            color: var(--text-primary);
        }

        .notion-button {
            background: var(--accent-color);
            color: white !important;
            border: none;
            padding: 8px 16px;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: all 0.15s ease;
            font-family: inherit;
            font-size: 14px;
        }

        .notion-button:hover {
            opacity: 0.85;
            transform: translateY(-0.5px);
        }

        .notion-input {
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 8px 12px;
            background: var(--bg-color);
            color: var(--text-primary);
            font-family: inherit;
            transition: border-color 0.15s ease;
        }

        .notion-input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 2px rgba(46, 170, 220, 0.2);
        }

        .notion-select {
            appearance: none;
            background: var(--bg-color) url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23787774'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e") no-repeat right 8px center;
            background-size: 16px;
            padding-right: 28px;
        }

        .rate-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid var(--border-color);
            font-size: 14px;
        }

        .converter-group {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 12px;
            align-items: center;
        }

        #swap-currencies {
            background: none;
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            padding: 6px;
            margin: 0 8px;
        }

        #conversion-result {
            margin-top: 16px;
            padding: 12px;
            background: var(--bg-color);
            border-radius: var(--border-radius);
            font-size: 14px;
        }
    </style>
</head>
<body>
    <!-- 汇率显示组件 -->
    <div class="notion-container">
        <h3 class="notion-title">实时汇率</h3>
        <button class="notion-button" id="update-rates">更新汇率</button>
        <div id="rates-container" style="margin-top: 16px;">
            <div class="rate-item">
                <span>USD/CNY</span>
                <span id="usd-cny">--</span>
            </div>
            <div class="rate-item">
                <span>MOP/HKD</span>
                <span id="mop-hkd">--</span>
            </div>
            <div class="rate-item">
                <span>TWD/USD</span>
                <span id="twd-usd">--</span>
            </div>
            <div class="rate-item">
                <span>HKD/USD</span>
                <span id="hkd-usd">--</span>
            </div>
        </div>
        <div style="margin-top: 12px; font-size: 12px; color: var(--text-secondary);">
            最后更新：<span id="update-date">--</span>
        </div>  
    </div>

    <!-- 货币转换组件 -->
    <div class="notion-container">
        <h3 class="notion-title">货币转换</h3>
        <div class="converter-group">
            <input type="number" class="notion-input notion-select" id="amount" placeholder="0.00">
            <select class="notion-input notion-select" id="from-currency"></select>
            <button class="notion-button" id="swap-currencies" style="padding: 8px;">⇄</button>
            <select class="notion-input notion-select" id="to-currency"></select>
        </div>
        <div id="conversion-result"></div>
    </div>


<script>
// 通用配置
const API_URL = 'https://api.currencyapi.com/v3/latest?apikey=cur_live_os1dTEv8zwFkJZ0DitDtQWQf7gLkU3ObCIlaZsJr&currencies=CNY%2CHKD%2CTWD%2CMOP%2CKRW%2CEUR';
const CURRENCIES = ['USD', 'CNY', 'HKD', 'TWD', 'KRW', 'MOP', 'EUR'];
let lastRates = null; // 存储最新汇率数据

// 初始化下拉菜单
function initCurrencySelectors() {
    const fromSelect = document.getElementById('from-currency');
    const toSelect = document.getElementById('to-currency');
    
    CURRENCIES.forEach(currency => {
        fromSelect.appendChild(new Option(currency, currency));
        toSelect.appendChild(new Option(currency, currency));
    });
    fromSelect.value = 'USD';
    toSelect.value = 'CNY';
}

// 获取并更新汇率数据
async function fetchExchangeRates() {
    try {
        const response = await fetch(API_URL);
        if (!response.ok) throw new Error('网络请求失败');
        const data = await response.json();
        
        // 处理汇率数据（API返回的是USD作为基准货币的汇率）
        const rates = { USD: 1 }; // 添加USD基准汇率
        Object.entries(data.data).forEach(([code, info]) => {
            rates[code] = info.value;
        });

        // 存储数据并更新显示
        lastRates = {
            rates,
            date: new Date(data.meta.last_updated_at)
        };
        updateRateDisplay();
    } catch (error) {
        console.error('获取汇率失败:', error);
        document.getElementById('update-status').textContent = '汇率更新失败，请稍后重试';
    }
}

// 更新汇率显示
function updateRateDisplay() {
    if (!lastRates) return;

    const { rates, date } = lastRates;
    document.getElementById('update-status').textContent = '最新汇率：';

            element.textContent = value?.toLocaleString('en', { 
            minimumFractionDigits: 4,
            maximumFractionDigits: 4 
        }) || '--';
    
    // 计算并显示特定货币对汇率
    document.getElementById('usd-cny').textContent = rates.CNY?.toFixed(4) || '--';
    document.getElementById('mop-hkd').textContent = (rates.HKD / rates.MOP)?.toFixed(4) || '--';
    document.getElementById('twd-usd').textContent = (1 / rates.TWD)?.toFixed(4) || '--';
    document.getElementById('hkd-usd').textContent = (1 / rates.HKD)?.toFixed(4) || '--';
    document.getElementById('update-date').textContent = date.toLocaleString();
}

// 执行货币转换
function performConversion() {
    if (!lastRates) {
        document.getElementById('conversion-result').textContent = '请先获取最新汇率';
        return;
    }

    const amount = parseFloat(document.getElementById('amount').value);
    if (isNaN(amount)) {
        document.getElementById('conversion-result').textContent = '请输入有效金额';
        return;
    }

    const from = document.getElementById('from-currency').value;
    const to = document.getElementById('to-currency').value;
    const converted = amount * (lastRates.rates[to] / lastRates.rates[from]);
    
    document.getElementById('conversion-result').textContent = 
        `${amount.toFixed(2)} ${from} = ${converted.toFixed(2)} ${to}`;

    resultElement.textContent = `${amount.toLocaleString()} ${from} = ${converted.toLocaleString()} ${to}`;
}

// 货币互换功能
function swapCurrencies() {
    const from = document.getElementById('from-currency');
    const to = document.getElementById('to-currency');
    [from.value, to.value] = [to.value, from.value];
    performConversion();
}

// 初始化
document.addEventListener('DOMContentLoaded', () => {
    initCurrencySelectors();
    
    // 绑定事件监听
    document.getElementById('update-rates').addEventListener('click', fetchExchangeRates);
    document.getElementById('swap-currencies').addEventListener('click', swapCurrencies);
    document.getElementById('amount').addEventListener('input', performConversion);
    document.getElementById('from-currency').addEventListener('change', performConversion);
    document.getElementById('to-currency').addEventListener('change', performConversion);
});
</script>
</body>
</html>
